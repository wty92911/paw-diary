# ESLint Configuration Guide

## Overview

This project uses a comprehensive ESLint configuration to maintain code quality, enforce best practices, and detect potential issues early. The configuration is optimized for TypeScript + React development with Tauri.

## Installed Plugins

### Core Plugins
- **typescript-eslint**: TypeScript-specific linting rules
- **eslint-plugin-react**: React best practices and patterns
- **eslint-plugin-react-hooks**: React Hooks rules
- **eslint-plugin-react-refresh**: Vite Fast Refresh compatibility

### Code Quality Plugins
- **eslint-plugin-unused-imports**: Automatically detect and remove unused imports
- **eslint-plugin-sonarjs**: Advanced code smell detection and complexity analysis
- **eslint-plugin-jsx-a11y**: Accessibility (a11y) rules for JSX elements

## Rule Categories

### 1. Unused Code Analysis

**Purpose**: Detect and eliminate dead code and unused imports

- `unused-imports/no-unused-imports`: **error** - Automatically flag unused imports
- `unused-imports/no-unused-vars`: **warn** - Detect unused variables (with `_` prefix exception)
- `@typescript-eslint/no-unused-vars`: **off** - Disabled in favor of unused-imports plugin

**Benefits**:
- Cleaner codebase with no dead imports
- Reduced bundle size
- Better code maintainability

### 2. Code Quality & Complexity

**Purpose**: Prevent overly complex code that's hard to maintain

#### Complexity Limits
- `complexity`: **warn** at 15 - Maximum cyclomatic complexity per function
- `max-lines-per-function`: **warn** at 100 lines - Keep functions concise
- `max-depth`: **warn** at 4 - Limit nesting depth
- `max-nested-callbacks`: **warn** at 3 - Prevent callback hell

#### SonarJS Quality Rules
- `sonarjs/cognitive-complexity`: **warn** at 15 - Measure mental effort to understand code
- `sonarjs/no-duplicate-string`: **warn** at 3 occurrences - Extract repeated strings to constants
- `sonarjs/no-identical-functions`: **warn** - Detect duplicate function implementations
- `sonarjs/no-inverted-boolean-check`: **error** - Use simpler boolean expressions
- `sonarjs/prefer-immediate-return`: **warn** - Return directly instead of using temp variables
- `sonarjs/no-small-switch`: **warn** - Use if-else for switches with 2 cases or fewer
- `sonarjs/pseudo-random`: **error** - Flag unsafe random number generation
- `sonarjs/todo-tag`: **error** - Require TODO comments to be completed
- `sonarjs/no-nested-conditional`: **error** - Avoid nested ternary operators
- `sonarjs/no-redundant-assignments`: **error** - Remove unnecessary variable assignments

**Benefits**:
- More maintainable code
- Easier to understand and debug
- Reduced cognitive load for developers
- Fewer bugs from complex logic

### 3. TypeScript Strict Rules

**Purpose**: Enforce type safety and best practices

- `@typescript-eslint/no-explicit-any`: **error** - Prevent `any` type usage
- `@typescript-eslint/consistent-type-imports`: **warn** - Use `import type` for type-only imports
- `@typescript-eslint/explicit-function-return-type`: **off** - Allow type inference
- `@typescript-eslint/explicit-module-boundary-types`: **off** - Allow type inference at boundaries

**Benefits**:
- Better type safety
- Improved IDE autocomplete
- Smaller bundle size (type imports are stripped)

### 4. React Best Practices

**Purpose**: Follow React patterns and avoid common pitfalls

- `react/prop-types`: **off** - Using TypeScript instead
- `react/react-in-jsx-scope`: **off** - Not needed with React 17+ JSX transform
- `react/jsx-no-target-blank`: **error** - Prevent security issues with `target="_blank"`
- `react/jsx-key`: **error** - Require keys in lists and fragments
- `react/no-array-index-key`: **warn** - Avoid using array index as key
- `react/jsx-no-useless-fragment`: **warn** - Remove unnecessary fragments
- `react/self-closing-comp`: **warn** - Use self-closing tags when appropriate

**Benefits**:
- Better React performance
- Avoid common React bugs
- More maintainable components

### 5. Accessibility (a11y)

**Purpose**: Ensure the application is accessible to all users

- `jsx-a11y/alt-text`: **error** - Require alt text for images
- `jsx-a11y/aria-props`: **error** - Validate ARIA properties
- `jsx-a11y/aria-proptypes`: **error** - Validate ARIA property types
- `jsx-a11y/aria-unsupported-elements`: **error** - Prevent ARIA on unsupported elements
- `jsx-a11y/role-has-required-aria-props`: **error** - Require ARIA props for roles
- `jsx-a11y/role-supports-aria-props`: **error** - Validate ARIA props for roles
- `jsx-a11y/click-events-have-key-events`: **warn** - Add keyboard support for click handlers
- `jsx-a11y/no-static-element-interactions`: **warn** - Use semantic HTML for interactions

**Benefits**:
- WCAG 2.1 AA compliance
- Better user experience for all users
- Screen reader compatibility
- Keyboard navigation support

### 6. Code Style

**Purpose**: Enforce consistent code style across the project

- `no-console`: **warn** - Only allow `console.warn` and `console.error`
- `no-debugger`: **error** - No debugger statements in production
- `no-useless-escape`: **error** - Remove unnecessary escape characters
- `prefer-const`: **error** - Use const for variables that don't change
- `no-var`: **error** - Use let/const instead of var
- `eqeqeq`: **error** - Use `===` instead of `==` (except for null checks)

**Benefits**:
- Consistent codebase
- Fewer bugs from type coercion
- Better debugging experience

## Running ESLint

### Check for Issues
```bash
yarn lint
```

### Auto-fix Issues
```bash
yarn lint --fix
```

### Check Specific Files
```bash
yarn lint src/components/MyComponent.tsx
```

## Common Issues and Solutions

### 1. Unused Imports
**Issue**: `unused-imports/no-unused-imports`
**Solution**: Remove the unused import or use it in the code

### 2. Function Too Complex
**Issue**: `complexity` or `sonarjs/cognitive-complexity`
**Solution**: Break down the function into smaller, focused functions

### 3. Function Too Long
**Issue**: `max-lines-per-function`
**Solution**: Extract logic into helper functions or custom hooks

### 4. Duplicate Strings
**Issue**: `sonarjs/no-duplicate-string`
**Solution**: Extract repeated strings to constants
```typescript
const ERROR_MESSAGE = 'An error occurred';
// Use ERROR_MESSAGE instead of repeating the string
```

### 5. Array Index as Key
**Issue**: `react/no-array-index-key`
**Solution**: Use unique IDs instead of array indices
```typescript
// Bad
{items.map((item, index) => <div key={index}>{item}</div>)}

// Good
{items.map((item) => <div key={item.id}>{item}</div>)}
```

### 6. Accessibility Issues
**Issue**: Various `jsx-a11y/*` rules
**Solution**: Add proper ARIA attributes, alt text, and keyboard support

### 7. Nested Ternaries
**Issue**: `sonarjs/no-nested-conditional`
**Solution**: Extract to variables or use if-else statements
```typescript
// Bad
const result = condition1 ? value1 : condition2 ? value2 : value3;

// Good
const result = (() => {
  if (condition1) return value1;
  if (condition2) return value2;
  return value3;
})();
```

## Exceptions and Overrides

### Header Components
Files in `src/components/header/**` have relaxed rules for:
- Naming conventions (allow both PascalCase and camelCase)
- Empty interfaces (for extending base types)

### Disabling Rules
Use sparingly and document why:
```typescript
// eslint-disable-next-line rule-name -- Explanation why
```

## Recommended Tools

### Additional Development Tools

1. **depcheck**: Find unused dependencies
```bash
npx depcheck
```

2. **Prettier**: Code formatting (already configured)
```bash
yarn format
```

3. **TypeScript**: Type checking
```bash
yarn tsc --noEmit
```

## Integration with CI/CD

ESLint runs automatically:
- Pre-commit hooks via Git hooks
- CI/CD pipeline before deployment
- Max warnings: 0 (all warnings must be fixed)

## Performance Considerations

- **Lazy imports**: Use React.lazy for code splitting
- **Virtualization**: Use for long lists (TanStack Virtual)
- **Memoization**: Use React.memo, useMemo, useCallback appropriately
- **Bundle size**: Monitor with `yarn build` and check bundle analysis

## Resources

- [ESLint Documentation](https://eslint.org/docs/latest/)
- [TypeScript ESLint](https://typescript-eslint.io/)
- [SonarJS Rules](https://github.com/SonarSource/eslint-plugin-sonarjs)
- [React ESLint Plugin](https://github.com/jsx-eslint/eslint-plugin-react)
- [JSX a11y Plugin](https://github.com/jsx-eslint/eslint-plugin-jsx-a11y)
- [Unused Imports Plugin](https://github.com/sweepline/eslint-plugin-unused-imports)
